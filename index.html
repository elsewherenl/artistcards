<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
<!-- Bookmark/Apple touch icon (stamp logo) -->
<link rel="apple-touch-icon" sizes="180x180" href="Stamp Logo 180 x 180.png">
<title>Artist Prospecting</title>
<link href="https://fonts.googleapis.com/css2?family=Avenir&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
<link href="https://api.fontshare.com/v2/css?f[]=satoshi@700,500,400&display=swap" rel="stylesheet" />
<style>
    body {
    font-family: 'Satoshi', sans-serif;
    background-color: #F3EFE9;
    margin: 0;
    padding: 2rem;
    color: #0D0D0D;
    position: relative;
    }
    
    .header {
    position: relative;
    margin-bottom: 4rem;
    }
    
    .logo {
    position: absolute;
    top: 0;
    right: 0;
    width: 100px;
    height: 100px;
    background: #F3EFE9;
    border: 2px solid #0D0D0D;
    border-radius: 0;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-end;
    color: #0D0D0D;
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.7rem;
    font-weight: 500;
    line-height: 0.9;
    text-transform: lowercase;
    letter-spacing: 0.02em;
    padding: 0.5rem;
    padding-bottom: 0.8rem;
    box-sizing: border-box;
    text-decoration: none;
    }
    
    h1 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 2rem;
    font-weight: 500;
    margin-bottom: 0.25rem;
    margin-right: 120px;
    letter-spacing: -0.02em;
    }
    
    h2 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1rem;
    font-weight: 400;
    margin-top: 0;
    margin-left: 0;
    border-bottom: 2px solid #2552FF;
    padding-bottom: 0.25rem;
    padding-left: 0;
    display: inline-block;
    letter-spacing: -0.01em;
    }
    
    .summary {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(214, 179, 112, 0.15);
    border-radius: 0;
    padding: 1.5rem;
    margin-bottom: 2rem;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 2rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    }
    
    .summary-item {
    text-align: center;
    }
    
    .summary-number {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 2rem;
    font-weight: 500;
    color: #D6B370;
    display: block;
    line-height: 1;
    margin-bottom: 0.25rem;
    }
    
    .summary-label {
    font-family: 'Satoshi', sans-serif;
    font-size: 0.875rem;
    color: #666;
    font-weight: 500;
    letter-spacing: 0.05em;
    }
    
    .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
    }
    
.filter-select {
font-family: 'Satoshi', sans-serif;
font-size: 1rem;
font-weight: 400;
padding: 0.5rem 1rem;
border: 2px solid #D6B370;
border-radius: 20px;
background-color: white;
color: #0D0D0D;
width: 100%;
margin-top: 0.25rem;
transition: all 0.3s ease;
cursor: pointer;
}

.filter-select:focus {
    outline: none;
    border-color: #2552FF;
    box-shadow: 0 4px 12px rgba(37, 82, 255, 0.2);
    transform: translateY(-1px);
}

.filter-checkbox {
width: 1.1rem;
height: 1.1rem;
accent-color: #2552FF;
margin-top: 0.4rem;
transform: scale(1.1);
}

/* Search bar styling */
.search-container {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
}

.search-input {
    font-family: 'Satoshi', sans-serif;
    font-size: 0.85rem;
    font-weight: 500;
    padding: 0.5rem 1rem;
    border: 2px solid #D6B370;
    border-radius: 20px;
    background: white;
    color: #0D0D0D;
    width: 100%;
    max-width: 400px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(214, 179, 112, 0.1);
    text-transform: capitalize;
}

.search-input:focus {
    outline: none;
    border-color: #2552FF;
    box-shadow: 0 4px 12px rgba(37, 82, 255, 0.2);
    transform: translateY(-1px);
}

.search-input::placeholder {
    color: #999;
    font-style: italic;
    text-transform: none;
}

.clear-btn {
    padding: 0.5rem 1rem;
    border: 2px solid #D6B370;
    background: transparent;
    color: #0D0D0D;
    border-radius: 20px;
    cursor: pointer;
    font-family: 'Satoshi', sans-serif;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.3s ease;
    text-transform: capitalize;
    white-space: nowrap;
}

.clear-btn:hover {
    background: #D6B370;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(214, 179, 112, 0.3);
}

/* Status filter buttons */
.status-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1rem;
    justify-content: flex-start;
}

.status-btn {
    padding: 0.5rem 1rem;
    border: 2px solid #D6B370;
    background: transparent;
    color: #0D0D0D;
    border-radius: 20px;
    cursor: pointer;
    font-family: 'Satoshi', sans-serif;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.3s ease;
    text-transform: capitalize;
}

.status-btn.active {
    background: #D6B370;
    color: #0D0D0D;
}

.status-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(214, 179, 112, 0.3);
}

/* Status badges on cards */
.status-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    z-index: 1;
}

.status-prospect {
    background: rgba(214, 179, 112, 0.2);
    color: #a67c00;
    border: 1px solid rgba(214, 179, 112, 0.3);
}

.status-planned-outreach {
    background: rgba(168, 85, 247, 0.2);
    color: #7c3aed;
    border: 1px solid rgba(168, 85, 247, 0.3);
}

.status-outreach {
    background: rgba(37, 82, 255, 0.2);
    color: #1d4ed8;
    border: 1px solid rgba(37, 82, 255, 0.3);
}

.status-responded {
    background: rgba(34, 197, 94, 0.2);
    color: #15803d;
    border: 1px solid rgba(34, 197, 94, 0.3);
}

.status-spotlighted {
    background: rgba(249, 115, 22, 0.2);
    color: #ea580c;
    border: 1px solid rgba(249, 115, 22, 0.3);
}

.status-negotiating {
    background: rgba(147, 51, 234, 0.2);
    color: #7c3aed;
    border: 1px solid rgba(147, 51, 234, 0.3);
}

.status-featured {
    background: rgba(16, 185, 129, 0.2);
    color: #047857;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.status-feature.planned {
    background: rgba(245, 158, 11, 0.2);
    color: #d97706;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

@media (max-width: 768px) {
#filters {
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
}

.status-filters {
    flex-direction: column;
    gap: 0.5rem;
}

.status-btn {
    width: 100%;
    text-align: center;
}

.search-container {
    flex-direction: column;
    align-items: flex-start;
}

.clear-btn {
    width: 100%;
    max-width: 400px;
}
}

    .card {
    background: white;
    padding: 1.5rem;
    border-radius: 1rem;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    font-family: 'Satoshi', sans-serif;
    position: relative;
    }
    
    .artist-name {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 500;
    font-size: 1.25rem;
    letter-spacing: -0.02em;
    }
    
    .insta-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
    width: fit-content;
    color: #2552FF;
    font-family: 'Satoshi', sans-serif;
    font-weight: 500;
    }
    
    .insta-logo {
    width: 20px;
    height: 20px;
    }
    
    .image {
    width: 100%;
    height: auto;
    max-height: 320px;
    object-fit: cover;
    border-radius: 0.5rem;
    }
    
    .label {
    font-family: 'Satoshi', sans-serif;
    font-weight: 600;
    }
    
    .notes {
    font-family: 'Satoshi', sans-serif;
    font-size: 0.85rem;
    font-style: italic;
    color: #444;
    margin-top: 0.5rem;
    }
    
    .field-item {
    font-family: 'Satoshi', sans-serif;
    }
    
    .website-link {
    font-family: 'Satoshi', sans-serif;
    color: #2552FF;
    text-decoration: none;
    font-weight: 500;
    }
    
    .website-link:hover {
    text-decoration: underline;
    }
    
    .footer {
    text-align: left;
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(214, 179, 112, 0.2);
    }
    
    .footer-brand {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.8rem;
    font-weight: 700;
    color: #0D0D0D;
    letter-spacing: -0.02em;
    text-transform: lowercase;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    cursor: pointer;
    }
    
    .footer-brand:hover {
    transform: scale(1.05);
    transform-origin: left center;
    color: #D6B370;
    letter-spacing: 0.02em;
    }
    
    @media (max-width: 768px) {
    .logo {
        position: relative;
        margin: 0 auto 1rem auto;
        width: 80px;
        height: 80px;
        font-size: 0.6rem;
    }
    
    h1 {
        margin-right: 0;
        text-align: center;
    }
    
    h2 {
        text-align: center;
        display: block;
        width: 100%;
    }
    
    .footer {
        text-align: center;
    }
    }
.filter-reset {
  background-color: #2552FF;
  color: #fff;
  border: none;
  padding: 0.5rem 1rem;
  font-size: 0.85rem;
  border-radius: 20px;
  cursor: pointer;
  font-family: 'Satoshi', sans-serif;
  font-weight: 500;
  width: 100%;
  box-sizing: border-box;
  text-align: center;
  transition: all 0.3s ease;
  text-transform: capitalize;
  margin-top: 1.85rem;
}

.filter-reset:hover {
  background-color: #1f47d4;
}

#filters {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 1rem;
  margin-top: 1rem;
}

.no-results {
  color: #666;
  text-align: center;
  padding: 2rem 0;
  font-size: 1.2rem;
  opacity: 0.7;
}

/* Mobile UX improvements */
@media (max-width: 480px) {
  .summary-item label,
  .summary-label {
    font-size: 0.9rem;
  }

  .filter-select {
    font-size: 0.9rem;
    padding: 0.4rem 0.6rem;
  }

  .filter-checkbox {
    transform: scale(1.2);
    margin-top: 0.3rem;
  }

  #filters {
    row-gap: 1rem;
  }
}
@media (min-width: 768px) {
    .card img {
      transition: transform 0.3s ease;
    }

    .card:hover img {
      transform: scale(1.1);
    }
  }

  /* Mobile filter modal and toggle button styles */
  @media (max-width: 768px) {
    #filters {
      display: none;
      position: fixed;
      bottom: 60px;
      right: 1rem;
      background-color: #0D0D0D;
      padding: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      z-index: 1000;
      max-width: 90vw;
      flex-direction: column;
      row-gap: 1rem;
    }
    .filter-toggle {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      background-color: #2552FF;
      color: #fff;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1001;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
  }
  @media (min-width: 768px) {
    .filter-toggle {
      display: none;
    }
    #filters {
      display: grid !important;
      position: static !important;
      background-color: inherit !important;
      border: none !important;
      padding: 0 !important;
      box-shadow: none !important;
    }
  }
</style>
</head>
<body>
<div class="header">
    <div class="logo">
    <div>else</div>
    <div>where</div>
    <div>collective</div>
    </div>
    <h1>Artist Prospecting</h1>
    <h2>Ranked by creative fit</h2>
</div>

<!-- Search Bar -->
<div class="search-container">
    <input type="text" id="searchInput" class="search-input" placeholder="Search artists by name..." />
    <button id="resetFilters" class="clear-btn">Clear Filters</button>
</div>

<!-- Status Filter Buttons -->
<div class="status-filters">
    <button class="status-btn active" data-status="all">All</button>
    <button class="status-btn" data-status="prospect">Prospect</button>
    <button class="status-btn" data-status="planned outreach">Planned Outreach</button>
    <button class="status-btn" data-status="outreach">Outreach</button>
    <button class="status-btn" data-status="responded">Responded</button>
    <button class="status-btn" data-status="spotlighted">Spotlighted</button>
    <button class="status-btn" data-status="negotiating">Negotiating</button>
    <button class="status-btn" data-status="featured">Featured</button>
    <button class="status-btn" data-status="feature planned">Feature Planned</button>
</div>

<!-- Summary Dashboard -->
<div class="summary" id="summary">
<div class="summary-item">
<span class="summary-number" id="totalArtists">0</span>
<span class="summary-label">Total Artists</span>
</div>
<div class="summary-item">
<span class="summary-number" id="avgFollowers">0</span>
<span class="summary-label">Avg Followers</span>
</div>
<div class="summary-item">
<span class="summary-number" id="statusCounts">0</span>
<span class="summary-label">Current Filter</span>
</div>
<div class="summary-item">
<span class="summary-number" id="topGenre">-</span>
<span class="summary-label">Top Genre</span>
</div>
</div>
<div class="summary" id="filters" style="margin-top: 1rem; margin-bottom: 2rem;">
<div class="summary-item">
<label for="genreFilter" class="summary-label">Genre</label><br>
<select id="genreFilter" class="filter-select">
  <option value="All">All</option>
</select>
</div>
<div class="summary-item">
<label for="followersFilter" class="summary-label">Followers</label><br>
<select id="followersFilter" class="filter-select">
  <option value="All">All</option>
  <option value="under5k">Under 5k</option>
  <option value="5kto10k">5k–10k</option>
  <option value="10kplus">10k+</option>
</select>
</div>
<div class="summary-item">
<label for="sortByFilter" class="summary-label">Sort By</label><br>
<select id="sortByFilter" class="filter-select">
  <option value="none">Default</option>
  <option value="newest">Newest Added</option>
  <option value="oldest">Oldest Added</option>
  <option value="nameAZ">Name A-Z</option>
  <option value="nameZA">Name Z-A</option>
</select>
</div>
</div>


<div class="grid" id="cards"></div>

<div class="footer">
    <div class="footer-brand" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">elsewhere collective</div>
</div>

<!-- Filter Toggle Button (only on mobile) -->
<button class="filter-toggle" onclick="toggleFilters()">☰</button>

<script>
let currentStatusFilter = 'all';
let currentSearchTerm = '';

function toggleFilters() {
  const filters = document.getElementById("filters");
  filters.style.display = filters.style.display === "none" || filters.style.display === "" ? "flex" : "none";
}

function parseCSV(csv) {
    const lines = csv.split('\n');
    const result = [];
    const headers = [];
    let current = '', inQuotes = false;
    for (let i = 0; i < lines[0].length; i++) {
    const char = lines[0][i];
    if (char === '"') inQuotes = !inQuotes;
    else if (char === ',' && !inQuotes) {
        headers.push(current.trim().replace(/^"|"$/g, ''));
        current = '';
    } else current += char;
    }
    headers.push(current.trim().replace(/^"|"$/g, ''));

    for (let i = 1; i < lines.length; i++) {
    if (!lines[i].trim()) continue;
    const values = [], row = {};
    current = ''; inQuotes = false;
    for (let j = 0; j < lines[i].length; j++) {
        const char = lines[i][j];
        if (char === '"') inQuotes = !inQuotes;
        else if (char === ',' && !inQuotes) {
        values.push(current.trim().replace(/^"|"$/g, ''));
        current = '';
        } else current += char;
    }
    values.push(current.trim().replace(/^"|"$/g, ''));
    headers.forEach((header, idx) => row[header] = values[idx] || '');
    if (row[headers[0]]) result.push(row);
    }
    return result;
}

function getStatusClass(status) {
    if (!status) return 'status-prospect';
    const normalized = status.toLowerCase().replace(/\s+/g, '');
    if (normalized === 'featureplanned') return 'status-feature planned';
    if (normalized === 'plannedoutreach') return 'status-planned-outreach';
    return `status-${normalized}`;
}

fetch("https://docs.google.com/spreadsheets/d/1gGSXIb3_cwnnbbVk73lYDeOiZwQjYk3OGgJ3V8MYRtc/export?format=csv&gid=636920357")
    .then(res => res.text())
    .then(csvData => {
    const data = parseCSV(csvData);
    const genreSelect = document.getElementById("genreFilter");
    const followersSelect = document.getElementById("followersFilter");
    const sortBySelect = document.getElementById("sortByFilter");

    // Store all data for re-filtering
    let fullData = data;

    // Debug: Log the data structure
    console.log("First row of data:", data[0]);
    console.log("All column headers:", Object.keys(data[0] || {}));

    // Populate genres
    const genres = [...new Set(data.map(row => row["Genre"]).filter(Boolean))];
    console.log("Found genres:", genres);
    genres.sort().forEach(genre => {
        const option = document.createElement("option");
        option.value = genre;
        option.textContent = genre;
        genreSelect.appendChild(option);
    });

    // Status filter buttons
    document.querySelectorAll('.status-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentStatusFilter = btn.dataset.status;
            refreshUI();
        });
    });

    function filterData() {
        const genre = genreSelect.value;
        const followersRange = followersSelect.value;

        return fullData.filter(row => {
        // Status filter
        const status = (row["Current Status"] || "").toLowerCase().trim();
        const statusMatch = currentStatusFilter === 'all' || status === currentStatusFilter.toLowerCase();
        
        // Search filter
        const artistName = (row["Instagram Name"] || row["Artist"] || "").toLowerCase();
        const searchMatch = !currentSearchTerm || artistName.includes(currentSearchTerm.toLowerCase());
        
        const genreMatch = genre === "All" || row["Genre"] === genre;
        
        // Followers filter
        let followers = 0;
        const raw = row["Instagram Followers - Do not delete"] || '';
        const str = raw.toLowerCase().replace(/,/g, '');
        if (str.includes('k')) followers = parseFloat(str.replace('k', '')) * 1000;
        else followers = parseInt(str) || 0;
        let followersMatch = true;
        if (followersRange === "under5k") followersMatch = followers < 5000;
        else if (followersRange === "5kto10k") followersMatch = followers >= 5000 && followers <= 10000;
        else if (followersRange === "10kplus") followersMatch = followers > 10000;
        
        return statusMatch && searchMatch && genreMatch && followersMatch;
        });
    }

    function parseDate(dateString) {
        if (!dateString) return new Date("1900-01-01");
        
        // Handle DD.MM.YY format (like 01.08.25)
        if (dateString.includes(".") && dateString.length === 8) {
            const parts = dateString.split(".");
            if (parts.length === 3) {
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1; // JavaScript months are 0-indexed
                let year = parseInt(parts[2]);
                
                // Convert 2-digit year to 4-digit (assuming 20xx for now)
                if (year < 100) {
                    year = 2000 + year;
                }
                
                return new Date(year, month, day);
            }
        }
        
        // Handle DD/MM/YYYY format (European)
        if (dateString.includes("/")) {
            const parts = dateString.split("/");
            if (parts.length === 3) {
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1; // JavaScript months are 0-indexed
                const year = parseInt(parts[2]);
                return new Date(year, month, day);
            }
        }
        
        // Handle DD-MM-YYYY format
        if (dateString.includes("-") && dateString.length === 10) {
            const parts = dateString.split("-");
            if (parts.length === 3 && parts[0].length === 2) {
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1;
                const year = parseInt(parts[2]);
                return new Date(year, month, day);
            }
        }
        
        // Try standard JavaScript parsing (handles YYYY-MM-DD, etc.)
        const standardDate = new Date(dateString);
        if (!isNaN(standardDate.getTime())) {
            return standardDate;
        }
        
        // Fallback if nothing works
        console.warn("Could not parse date:", dateString);
        return new Date("1900-01-01");
    }

    function sortData(data) {
        const sortBy = sortBySelect.value;
        
        if (sortBy === "none") return data;
        
        return [...data].sort((a, b) => {
            if (sortBy === "newest") {
                const dateA = parseDate(a["When Added"]);
                const dateB = parseDate(b["When Added"]);
                
                // Debug: Log the dates being compared
                console.log("Sorting newest - A:", a["When Added"], "parsed:", dateA, "B:", b["When Added"], "parsed:", dateB);
                
                return dateB - dateA; // Newest first
            } else if (sortBy === "oldest") {
                const dateA = parseDate(a["When Added"]);
                const dateB = parseDate(b["When Added"]);
                
                // Debug: Log the dates being compared
                console.log("Sorting oldest - A:", a["When Added"], "parsed:", dateA, "B:", b["When Added"], "parsed:", dateB);
                
                return dateA - dateB; // Oldest first
            } else if (sortBy === "nameAZ") {
                const nameA = (a["Instagram Name"] || a["Artist"] || "").toLowerCase();
                const nameB = (b["Instagram Name"] || b["Artist"] || "").toLowerCase();
                return nameA.localeCompare(nameB);
            } else if (sortBy === "nameZA") {
                const nameA = (a["Instagram Name"] || a["Artist"] || "").toLowerCase();
                const nameB = (b["Instagram Name"] || b["Artist"] || "").toLowerCase();
                return nameB.localeCompare(nameA);
            }
            return 0;
        });
    }

    function renderCards(dataset) {
        const container = document.getElementById("cards");
        if (dataset.length === 0) {
          container.innerHTML = "<p class='no-results'>No artists match these filters.</p>";
          return;
        }
        container.innerHTML = "";
        dataset.forEach((row) => {
        const card = document.createElement("div");
        card.className = "card";

        // Add status badge
        const status = row["Current Status"] || "Prospect";
        const statusBadge = document.createElement("div");
        statusBadge.className = `status-badge ${getStatusClass(status)}`;
        statusBadge.textContent = status;
        card.appendChild(statusBadge);

        const name = document.createElement("div");
        name.className = "artist-name";
        name.textContent = row["Artist"] || row["Instagram Name"] || "Untitled";
        card.appendChild(name);

        const insta = document.createElement("a");
        insta.className = "insta-link";
        insta.href = row["Insta Handle"] || "#";
        insta.target = "_blank";
        const img = document.createElement("img");
        img.src = "https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png";
        img.alt = "Instagram";
        img.className = "insta-logo";
        insta.appendChild(img);
        insta.append("Insta");
        card.appendChild(insta);

        if (row["Image"]) {
            const image = document.createElement("img");
            image.className = "image";
            image.src = row["Image"];
            image.alt = row["Instagram Name"];
            image.loading = "lazy";
            card.appendChild(image);
        }

        const fields = [
            { label: "Genre", key: "Genre" },
            { label: "Followers", key: "Instagram Followers - Do not delete" },
            { label: "Where Found", key: "Where Found" },
            { label: "Current Status", key: "Current Status" },
        ];

        fields.forEach(({ label, key }) => {
            if (row[key]) {
            const el = document.createElement("div");
            el.className = "field-item";
            el.innerHTML = `<span class="label">${label}:</span> ${row[key]}`;
            card.appendChild(el);
            }
        });

        // Show "When Featured" date for Featured or Spotlighted status
        const cardStatus = (row["Current Status"] || "").toLowerCase().trim();
        if ((cardStatus === "featured" || cardStatus === "spotlighted") && row["Spotlighted"]) {
            const whenFeatured = document.createElement("div");
            whenFeatured.className = "field-item";
            whenFeatured.innerHTML = `<span class="label">When Featured:</span> ${row["Spotlighted"]}`;
            card.appendChild(whenFeatured);
        }

        const websiteFields = [
            { label: "Own Website", key: "Own Website" },
            { label: "Easy Commerce", key: "Website with easy commerce" },
            { label: "Gallery Rep", key: "Gallery Representation" }
        ];

        websiteFields.forEach(({ label, key }) => {
            if (row[key]) {
            const el = document.createElement("div");
            el.className = "field-item";
            if (key === "Own Website" && row[key] !== "No") {
                el.innerHTML = `<span class="label">${label}:</span> <a href="${row[key]}" target="_blank" class="website-link">Visit Site</a>`;
            } else {
                el.innerHTML = `<span class="label">${label}:</span> ${row[key]}`;
            }
            card.appendChild(el);
            }
        });

        if (row["Notes"]) {
            const notes = document.createElement("div");
            notes.className = "notes";
            notes.textContent = row["Notes"];
            card.appendChild(notes);
        }

        container.appendChild(card);
        });
    }

    function updateStats(filtered) {
        const followersData = filtered
        .map(row => {
            const followers = row["Instagram Followers - Do not delete"];
            if (!followers) return 0;
            const str = followers.toString().toLowerCase().replace(/,/g, '');
            return str.includes('k')
            ? parseFloat(str.replace('k', '')) * 1000
            : parseInt(str) || 0;
        }).filter(n => n > 0);
        const avgFollowers = followersData.length > 0
        ? Math.round(followersData.reduce((a, b) => a + b, 0) / followersData.length)
        : 0;
        
        const genres = filtered.map(r => r["Genre"]).filter(Boolean)
        .reduce((acc, g) => (acc[g] = (acc[g] || 0) + 1, acc), {});
        const topGenre = Object.entries(genres).sort((a, b) => b[1] - a[1])[0]?.[0] || "-";

        document.getElementById("totalArtists").textContent = filtered.length;
        document.getElementById("avgFollowers").textContent = avgFollowers > 1000 ? (avgFollowers / 1000).toFixed(1) + 'k' : avgFollowers.toLocaleString();
        document.getElementById("statusCounts").textContent = filtered.length;
        document.getElementById("topGenre").textContent = topGenre;
    }

    function refreshUI() {
        const filtered = filterData();
        const sorted = sortData(filtered);
        renderCards(sorted);
        updateStats(filtered);
    }

    // Search input listener
    const searchInput = document.getElementById("searchInput");
    searchInput.addEventListener("input", (e) => {
        currentSearchTerm = e.target.value;
        refreshUI();
    });

    genreSelect.addEventListener("change", refreshUI);
    followersSelect.addEventListener("change", refreshUI);
    sortBySelect.addEventListener("change", refreshUI);

    refreshUI(); // Initial render
    
    // Reset Filters button
    document.getElementById("resetFilters").addEventListener("click", () => {
      genreSelect.value = "All";
      followersSelect.value = "All";
      sortBySelect.value = "none";
      searchInput.value = "";
      currentSearchTerm = "";
      currentStatusFilter = 'all';
      document.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
      document.querySelector('.status-btn[data-status="all"]').classList.add('active');
      renderCards(fullData);
      updateStats(fullData);
      // On mobile, hide filters after reset
      if (window.innerWidth <= 768) {
        document.getElementById("filters").style.display = "none";
      }
    });
    
    // Hide filters on resize to mobile
    window.addEventListener('resize', function() {
      if (window.innerWidth <= 768) {
        document.getElementById("filters").style.display = "none";
      } else {
        document.getElementById("filters").style.display = "grid";
      }
    });
    
    // Initial state for filters on load (mobile hidden)
    if (window.innerWidth <= 768) {
      document.getElementById("filters").style.display = "none";
    }
    })
    .catch(err => {
    console.error("Error loading data:", err);
    console.error("Error details:", err.message);
    console.error("Stack trace:", err.stack);
    document.getElementById("summary").innerHTML = "<div style='text-align: center; color: red; padding: 2rem;'>Error loading artist data. Check console for details.</div>";
    });
</script>
</body>
</html>
